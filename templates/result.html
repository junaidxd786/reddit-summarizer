<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Reddit Thread Summarizer - Results</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { font-family: 'Roboto', Arial, sans-serif; background: #f6f7f8; }
        .copy-tooltip { display: none; position: absolute; top: 0.2em; right: 6.5em; background: #222; color: #fff; padding: 0.2em 0.7em; border-radius: 4px; font-size: 0.9em; z-index: 10; white-space: nowrap; }
        .show-tooltip { display: inline-block !important; }
        .flair { color: #008060; font-weight: bold; margin-right: 0.5em; }
        .score { color: #0079d3; font-weight: bold; }
        .faqs .score { color: #a259e6; }
        .experts .score { color: #00b894; }
        .funny .score { color: #d3007f; }
        .back-btn { display: block; margin: 2em auto 0 auto; background: #0079d3; color: #fff; border: none; border-radius: 6px; padding: 1em 2em; font-size: 1.2em; font-weight: 700; cursor: pointer; text-align: center; text-decoration: none; transition: background 0.2s; min-width: 44px; min-height: 44px; }
        .back-btn:hover { background: #005fa3; }
        @media (max-width: 800px) {
            .back-btn { width: 100%; font-size: 1.1em; min-width: 44px; min-height: 44px; }
        }
    </style>
    <script>
    function copySection(id, btn) {
        var el = document.getElementById(id);
        var textToCopy = el.innerText || el.textContent;
        navigator.clipboard.writeText(textToCopy).then(function() {
            var tooltip = btn.nextElementSibling;
            tooltip.classList.add('show-tooltip');
            setTimeout(function(){ tooltip.classList.remove('show-tooltip'); }, 1200);
        }).catch(err => {
            console.error('Failed to copy text: ', err);
            alert('Failed to copy text. Please copy manually.');
        });
    }
    </script>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary mb-4">
      <div class="container-fluid">
        <a class="navbar-brand fw-bold" href="/">Reddit Thread Summarizer</a>
      </div>
    </nav>
    <div class="container mb-5">
        <div class="text-center mb-3">
            <a href="{{ result.thread_url }}" target="_blank" class="btn btn-outline-secondary">View Original Thread</a>
        </div>
        {% if result.sentiment_verdict %}
            <div class="card mb-4 shadow-sm" id="sentiment-section">
                <div class="card-header bg-primary text-white d-flex align-items-center justify-content-between">
                    <span>Sentiment Analysis</span>
                    <button class="btn btn-light btn-sm ms-2" onclick="copySection('sentiment-section', this)">Copy</button>
                    <span class="copy-tooltip">Copied!</span>
                </div>
                <div class="card-body"><p class="mb-0">{{ result.sentiment_verdict }}</p></div>
            </div>
        {% endif %}
        {% if result.summary %}
            <div class="card mb-4 shadow-sm" id="summary-section">
                <div class="card-header bg-primary text-white d-flex align-items-center justify-content-between">
                    <span>Summary</span>
                    <button class="btn btn-light btn-sm ms-2" onclick="copySection('summary-section', this)">Copy</button>
                    <span class="copy-tooltip">Copied!</span>
                </div>
                <div class="card-body"><p class="mb-0">{{ result.summary }}</p></div>
            </div>
        {% endif %}
        {% if result.top_comments %}
            <div class="card mb-4 shadow-sm" id="top-comments-section">
                <div class="card-header bg-primary text-white d-flex align-items-center justify-content-between">
                    <span>Top Comments</span>
                    <button class="btn btn-light btn-sm ms-2" onclick="copySection('top-comments-section', this)">Copy</button>
                    <span class="copy-tooltip">Copied!</span>
                </div>
                <div class="card-body">
                    <ul class="list-group list-group-flush">
                    {% for comment, score in result.top_comments %}
                        <li class="list-group-item"><span class="score">▲ {{ score }}</span> {{ comment }}</li>
                    {% endfor %}
                    </ul>
                </div>
            </div>
        {% endif %}
        <div class="card mb-4 shadow-sm" id="links-section">
            <div class="card-header bg-primary text-white d-flex align-items-center justify-content-between">
                <span>Important Links</span>
                <button class="btn btn-light btn-sm ms-2" onclick="copySection('links-section', this)">Copy</button>
                <span class="copy-tooltip">Copied!</span>
            </div>
            <div class="card-body">
            {% if result.links and result.links|length > 0 %}
                <ul class="list-group list-group-flush">
                    {% for link in result.links %}
                        <li class="list-group-item"><a href="{{ link }}" target="_blank">{{ link }}</a></li>
                    {% endfor %}
                </ul>
            {% else %}
                <p class="mb-0">No links found.</p>
            {% endif %}
            </div>
        </div>
        {% if result.faqs %}
            <div class="card mb-4 shadow-sm" id="faqs-section">
                <div class="card-header bg-primary text-white d-flex align-items-center justify-content-between">
                    <span>Frequently Asked Questions</span>
                    <button class="btn btn-light btn-sm ms-2" onclick="copySection('faqs-section', this)">Copy</button>
                    <span class="copy-tooltip">Copied!</span>
                </div>
                <div class="card-body">
                    <ul class="list-group list-group-flush">
                        {% for question, score in result.faqs %}
                            <li class="list-group-item"><span class="score">▲ {{ score }}</span> {{ question }}</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        {% endif %}
        {% if result.expert_opinions %}
            <div class="card mb-4 shadow-sm" id="experts-section">
                <div class="card-header bg-primary text-white d-flex align-items-center justify-content-between">
                    <span>Expert Opinions</span>
                    <button class="btn btn-light btn-sm ms-2" onclick="copySection('experts-section', this)">Copy</button>
                    <span class="copy-tooltip">Copied!</span>
                </div>
                <div class="card-body">
                    <ul class="list-group list-group-flush">
                    {% for comment, score, flair in result.expert_opinions %}
                        <li class="list-group-item"><span class="flair">[{{ flair }}]</span> <span class="score">▲ {{ score }}</span> {{ comment }}</li>
                    {% endfor %}
                    </ul>
                </div>
            </div>
        {% endif %}
        {% if result.funny_comments %}
            <div class="card mb-4 shadow-sm" id="funny-section">
                <div class="card-header bg-primary text-white d-flex align-items-center justify-content-between">
                    <span>Notable Comments</span>
                    <button class="btn btn-light btn-sm ms-2" onclick="copySection('funny-section', this)">Copy</button>
                    <span class="copy-tooltip">Copied!</span>
                </div>
                <div class="card-body">
                    <ul class="list-group list-group-flush">
                    {% for comment, score in result.funny_comments %}
                        <li class="list-group-item"><span class="score">▲ {{ score }}</span> {{ comment }}</li>
                    {% endfor %}
                    </ul>
                </div>
            </div>
        {% endif %}
        <div class="card mb-4 shadow-sm" id="action-items-section">
            <div class="card-header bg-primary text-white d-flex align-items-center justify-content-between">
                <span>Action Items & Notes</span>
                <button class="btn btn-light btn-sm ms-2" onclick="copySection('action-items-section', this)">Copy</button>
                <span class="copy-tooltip">Copied!</span>
            </div>
            <div class="card-body">
            {% if action_items_html %}
                {{ action_items_html|safe }}
            {% else %}
                <p class="mb-0">No action items found.</p>
            {% endif %}
            </div>
        </div>
        <div class="card mb-4 shadow-sm" id="key-facts-section">
            <div class="card-header bg-primary text-white d-flex align-items-center justify-content-between">
                <span>Key Facts</span>
                <button class="btn btn-light btn-sm ms-2" onclick="copySection('key-facts-section', this)">Copy</button>
                <span class="copy-tooltip">Copied!</span>
            </div>
            <div class="card-body">
            {% if key_facts_html %}
                {{ key_facts_html|safe }}
            {% else %}
                <p class="mb-0">No key facts found.</p>
            {% endif %}
            </div>
        </div>
        <div class="d-flex gap-2 justify-content-center mt-4">
            <a href="/" class="btn btn-outline-primary">Back to Home</a>
            <a href="/" class="btn btn-primary">Enter a New Link</a>
            <button class="btn btn-success" onclick="shareResults()">Share</button>
        </div>
    </div>
    <!-- Footer -->
    <footer class="bg-light text-center text-muted py-3 mt-5">
        <div>Powered by Junaid</div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
    function copySection(id, btn) {
        var el = document.getElementById(id);
        var textToCopy = el.innerText || el.textContent;
        navigator.clipboard.writeText(textToCopy).then(function() {
            var tooltip = btn.nextElementSibling;
            tooltip.classList.add('show-tooltip');
            setTimeout(function(){ tooltip.classList.remove('show-tooltip'); }, 1200);
        }).catch(err => {
            console.error('Failed to copy text: ', err);
            alert('Failed to copy text. Please copy manually.');
        });
    }
    
    function shareResults() {
        if (navigator.share) {
            navigator.share({
                title: 'Reddit Thread Summary',
                text: 'Check out this Reddit thread summary!',
                url: window.location.href
            });
        } else {
            // Fallback: copy URL to clipboard
            navigator.clipboard.writeText(window.location.href).then(function() {
                alert('Link copied to clipboard!');
            }).catch(function() {
                alert('Share this link: ' + window.location.href);
            });
        }
    }
    </script>
</body>
</html>